<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.olympics.mvc.model.dao.PlayerDao">

	<!-- 올림픽 팀 생성 (자동 생성된 ID 매핑) -->
    <insert id="insertOlympics" parameterType="Player" useGeneratedKeys="true" keyProperty="olympicsId">
        INSERT INTO olympics (user_id, olympics_name)
        VALUES (#{userId}, #{olympicsName});
    </insert>
	
	<!-- 여러 플레이어 일괄 삽입 -->
	<insert id="insertPlayers" parameterType="list" useGeneratedKeys="true" keyColumn="player_id">
		INSERT INTO players (olympics_id, player_name, total_score, reg_date)
        VALUES
        <foreach collection="players" item="player" separator=",">
            (#{player.olympicsId}, #{player.playerName}, #{player.totalScore}, NOW())
        </foreach>
        ;
    </insert>
	
	<!-- 특정 올림픽 팀원 조회 -->
	<select id="getPlayersByOlympicsId" parameterType="int" resultType="Player">
		SELECT * FROM players
		WHERE olympics_id = #{olympicsId};
	</select>
	<!-- 해당 올림픽 생성한 user 조회 -->
	<select id="selectGenerateUserId" parameterType="int" resultType="int">
		SELECT user_id FROM olympics
		WHERE olympics_id = #{olympicsId};
	</select>
	
	<!-- 올림픽 팀 삭제 -->
	<delete id="deleteOlympics" parameterType="int">
		DELETE FROM olympics
		WHERE olympics_id = #{olympicsId};
	</delete>
	
</mapper>